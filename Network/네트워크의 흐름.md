# 주소 창에 도메인을 입력하여 서버에 접속할 때 일어나는 일

브라우저에 URL을 입력하고 Enter키를 누르게 되면 브라우저는 URL의 구조를 해석한다. 어떤 프로토콜로 어느 도메인의 어떤 포트로 보낼지 해석하는 것이다.

명시적으로 포트를 선언하지 않았다면 브라우저는 설정된 기본값을 이용하여 요청을 하게 된다. HTTP라면 80 포트, HTTPS라면 443 포트이다.

`www.naver.com`이라는 도메인은 컴퓨터가 읽을 수 있는 IP 주소로 변환해야 한다. 이는 DNS에서 조회하게 된다.

그 전에 우선 자신의 로컬 host 파일과 브라우저 캐시에 해당 도메인에 대한 정보가 존재하는지 확인한다.

존재하지 않을 경우 DNS에 요청을 하게 된다.

DNS는 요청받은 IP 주소를 아래와 같은 과정을 거쳐 IP주소를 확인한다.

1. 미리 설정 된 Local DNS에 해당 URL 주소의 IP주소를 요청합니다.
2. Local DNS에 해당 IP주소가 존재한다면 이를 응답하고, 없다면 다른 DNS 서버와 통신합니다. root DNS 서버에 해당 URL의 IP주소를 요청합니다.
3. root DNS서버에 해당 IP주소가 없다면 하위 DNS 서버에 요청하라고 응답합니다. 이 응답을 받은 Local DNS는. net 도메인을 관리하는 DNS 서버에  같은 내용을 요청합니다.
4. .net DNS 서버에 해당 IP주소가 없다면 하위 DNS 서버에 요청하라고 응답합니다. 이 응답을 받은 Local DNS는 daum.net 도메인을 관리하는 DNS 서버에 같은 내용을 요청합니다.
5. daum.net DNS 서버에서 IP주소를 응답받은 Local DNS는 해당 IP주소를 캐싱하고 응답합니다.

DNS를 통해 받은 IP주소를 통해 해당 목적지로 요청을 보낸다. 목적지 까지의 경로에 존재하는 라우터에는 라우팅 테이블이 존재한다.

라우팅 테이블을 확인하여 요청이 어떤 경로로 이동해야 할지 파악하고 라우터는 요청을 이동시킨다.

목적지의 네트워크에 요청이 도착하면 네트워크의 ARP는 IP 주소를 MAC 주소로 변환시킨다. 왜냐하면 IP 주소는 가상의 주소이기 때문에 이를 실질적인 물리적 주소인 MAC 주소가 필요하기 때문이다.

해당 네트워크 내에서 ARP를 브로드 캐스팅하면 IP 주소에 해당하는 노드는 자신의 MAC 주소를 응답한다.

이제 대상 서버와 통신하기 위해 TCP 소켓 연결을 시작한다. 연결은 3-웨이 핸드 쉐이크의 과정을 거치게 된다.

만약 요청이 HTTPS라면 암호화 통신을 위한 TLS 핸드쉐이킹이 추가된다.

연결이 확정되게 되면 필요한 페이지에 대한 정보를 요청한다. 서버는 요청을 수락할 수 있는지 확인한 후 이에 대한 응답을 보낸다.

서버에서 응답한 내용은 웹 페이지를 표시하기 위한 html, css, javascript 등으로 이루어져 있다.

브라우저는 이 코드들을 해석하여 브라우저의 페이지에 렌더링하게 되고 이로서 우리는 네이버 웹 페이지를 볼 수 있게 되는 것이다.