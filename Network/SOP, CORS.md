# SOP(Same-origin Policy)와 CORS(Cross-origin Resource Sharing)

웹 사이트 개발을 하다보면 내 서버에 다른 API 서버에 리소스를 요청하여 웹 페이지에 구성시킬 수 있다. 그런데 여기서 해당 접근을 막는 에러를 만날 수 있다. 이는 웹 브라우저가 기본적으로 특정 정책을 따르기 때문이다. 그러면 이 문제를 어떻게 해결할 수 있는지에 대해 알아보자.

## SOP(Same-origin Policy)

SOP는 `동일 출처 정책`이라고 하여 어떤 출처에서 불러온 문서나 스크립트가 다른 출처에서 가져온 리소스와 상호작용하는 것을 제한하는 중요한 보안 방식이다.  
이 정책은 기본적으로 클라이언트가 특정 도메인("http://host.web.com")으로 리소스 요청을 보내면 서버 측은 해당 도메인으로만 응답을 보내야 한다는 것이다.  
정책에서 응답이 가능 또는 불가능한 예는 다음과 같다.

![SOP](./image/SOP_CORS(1).png)

해당 정책이 생긴 이유는 기본적으로 브라우저는 토큰이나 쿠키 등과 같이 사용자의 정보와 관련된 데이터를 저장하는데, 만약 해커가 이를 탈취해(CSRF, XSS) 인증 요청에 이를 실어보내고 그로인해 얻은 정보를 해커의 서버로 보내버린다면 이는 아주 심각한 문제가 될 수 있어서 라고 한다.

## CORS(Cross-origin Resource Sharing)

CORS는 `교차 출처 리소스 공유`라고 하여 위에서 언급한 SOP로 인해 막힌 `cross domain`을 풀어주는 것이다. 과거에는 웹 페이지가 현재에 비해 크게 복잡하지 않은 구조여서 굳이 다른 API 서버의 리소스를 요청해야 할 이유가 없었지만, 현재에는 많은 웹 페이지들이 다양한 기능을 제공해야 하는데 이를 자체적으로 다 개발하기가 어려워져 다른 서버로 부터 필요한 기능들을 받아와 사용하는 경우가 많아졌다.

그래서 초기에는 JSONP(JSON with Padding)라고 하여 해당 정책을 우회하여 cross domain을 하는 경우가 있었지만, CORS가 생기면서 더 이상 우회하지 않아도 되었다.

django에 CORS를 적용하는 방법과 관련해서는 다음 페이지를 참고하면 된다.

[https://github.com/adamchainz/django-cors-headers]

### CORS 란?? 요약정리

CORS(Cross Origin Resoures Sharing) 교차 출처 리소스 공유는 SOP(same origin policy)와 반대되는 개념으로 한 출처에서 실행 중인 웹 애플리케이션이 다른 출처의 선택한 자원에 접근할 수 있는 권한을 부여하도록 브라우저에 알려주는 체제이다. 기본적으로 브라우저는 다른 서버와 통신을 할 때 보안상의 이유로 제 3자의 서버가 개입하는 것을 금지하한다. 이를 허용해 주기 위해서 API 서버를 만들 때 CORS 설정을 통해 원하는 서버를 등록한다. 등록한 서버에 대해서는 클라이언트 별도의 요청이 안들어 간 상태에서도 서버끼리의 통신이 가능하게 된다.