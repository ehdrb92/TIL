Cache는 데이터나 값을 저장하는 임시 저장소로, 데이터를 더 빠르고 효율적으로 액세스할 수 있게 해준다.

캐시를 사용할 때는 서비스에 따라 다양한 방식의 전략이 사용될 수 있다.

* Look-Aside 읽기 전략

    이 방식은 먼저 앱이 데이터를 찾기 위해 캐시를 확인한다. 캐시에 데이터가 없다면 DB에서 확인하여 가져오고 데이터는 캐시에 저장한다. 다음번에 찾을 때 부터는 cache hit가 발생하게 된다.

    * 가장 범용적이며 읽기 요청이 많은 경우 적합하다.

* Read-Through 읽기 전략

    이 방식은 앱은 무조건 캐기를 바라보고, DB는 캐시를 바라보는 방식이다. 앱이 캐시에서 데이터를 찾지 못하였을 경우 캐시가 DB에서 데이터를 가져와 저장하고, 앱은 해당 데이터를 가져간다. 이 방식에서 처음 검색된 데이터는 무조건 cache miss가 발생하게 된다.

    * 동일한 데이터가 여러 번 읽기 요청이 되는 경우에 적합하다. 디스크 읽기 비용을 절약할 수 있다.
    * 첫 요청은 항상 Cache Miss가 발생하여 데이터가 로딩된다.

* Cache Warming 데이터 미리 캐싱해두기

    만약 캐시가 다운되어 모두 데이터를 잃는다면 이후 앱이 데이터를 요청하는 상황에서 데이터를 다시 저장해야해 성능 저하가 올 수 있다. 그래서 서비스를 시작하기 전 많은 읽기 요청이 들어올 데이터를 미리 캐시에 저장해 두는 작업을 말한다.

* Write-Through 쓰기 전략

    Read-Through와 사실상 같다. DB에 데이터를 저장할 때 먼저 캐시에 기록된 다음 DB에 저장되는 방식이다.

    * 캐시는 항상 최신 정보를 가지고 있고 DB와 동기화되어 데이터 일관성을 보장한다는 장점이 있다.
    * 저장할 때 마다 두 단계 스텝(앱 → Redis → DB)을 거쳐야 하기 때문에 추가 쓰기 시간이 발생하여 상대적으로 느리다는 단점이 있다. 그리고 저장하는 데이터가 재사용하지 않을 수도 있는데 무조건 캐시에 넣는 것은 리소스 낭비이다.

* Write-Around 쓰기 전략

    DB에만 데이터를 저장하고 읽은 데이터만 캐시에 저장하는 방식이다. 일단 모든 데이터는 DB에 저장되고 Cache Miss가 발생한 경우에만 DB에서 캐시로 데이터를 끌어오게 된다.

    * 자주 읽히지 않는 데이터는 캐시에 로드되지 않으니 리소스를 절약할 수 있다.
    * 캐시 내의 데이터와 DB내의 데이터가 다를 수 있다는 단점이 있다. (ex. 캐시에 이미 로드된 데이터를 수정할 경우)

* Write-Back 쓰기 전략

    쓰기 작업을 캐시에 먼저 저장했다가 특정 시점마다 DB에 저장하는 방식이다. 디스크 기반 DB로 치면 데이터를 굉장히 많이 써야되기 때문에 무조건 디스크에 저장해야 하는 상황에서 주로 사용한다. 매번 디스크 쓰기를 실행하면 시간이 오래 걸리기 때문에 캐시에 저장해두었다가 묶음으로 디스크 쓰기 작업을 실행해주는 것이다.

    * 쓰기가 많은 경우에 적합하다. DB 디스크 쓰기 비용을 절약할 수 있다. 그리고 특정 시점에만 DB에 쓰기 요청을 하기 때문에 DB 오류에도 탄력적이다.
    * 데이터를 캐시에 모두 모아뒀다가 DB에 옮기기 때문에 도중 캐시에 장애가 발생하면 데이터 유실이 크게 발생할 수 있다.
