# Docker 명령어 정리

## docker

* docker -v: 도커 버전확인
* docker pull {이미지명}:{태그}: 도커 이미지 내려받기. 모든 명령에서 태그의 경우 필수사항은 아니다.
* docker images: 도커 이미지 목록
* docker create {옵션} {이미지명}:{태그}: 도커 컨테이너 생성
* docker start {컨테이너 id 또는 이름}: 도커 컨테이너 시작하기
* docker attach {컨테이너 id 또는 이름}: 컨테이너 내 CLI 이용하기
* docker run {이미지명}:{태그}: 이미지로 컨테이너 만들어 시작하기
* docker restart {컨테이너 id 또는 이름}: 컨테이너 재시작
* exit 또는 Ctrl + D: 컨테이너 내부 쉘에서 빠져나오기 (컨테이너 종료)
* Ctrl + P, Q: 컨테이너 내부 쉘에서 빠져나오기 (컨테이너를 종료하지 않음)

* docker run [image_name]

    명령어를 실행하면 도커 어플리케이션 패키지(이미지)를 컨테이너로 실행한다. 만약 로컬에 이미지가 없더면 서버에서 이미지를 내려받은 후 실행한다.

* docker run --interactive --tty [image_name]

    --interactive 플래그를 사용하면 컨테이너에 접속된 상태가 된다. 그리고 --tty 플래그는 터미널 세션을 통해 컨테이너를 조작하겠다는 의미이다. 컨테이너 내부에서 명령 프롬프트를 통해 조작을 할 수 있게 된다.

* docker run --detach --publish 8088:80 [image_name]

    컨테이너가 백그라운드에서 동작하게 하면서 네트워크를 주시하게 하려면 두 개의 플래그를 붙여야 한다.

    + --detach: 컨테이너를 백그라운드에서 실행하며 컨테이너 ID를 출력한다.
    + --publish: 컨테이너의 포트를 호스트 컴퓨터에 공개한다.

    --detach 플래그를 이용해 실행된 컨테이너는 마치 리눅스 데몬이나 윈도 서비스처럼 백그라운드로 동작하며 겉으로 드러나지 않는다. 컨테이너의 포트를 호스트 컴퓨터에 공개하는 원리는 복잡하다. 도커를 설치하면 호스트 컴퓨터의 네트워크 계층에 도커가 끼어들게 된다. 그러면 호스트 컴퓨터에서 들고나는 네트워크 트래픽을 모두 도커가 가로채서 그 중 필요한 것을 컨테이너에 전달한다.

    각 컨테이너는 고유의 IP 주소를 갖지만, 이는 도커가 관리하는 내부 가상 네트워크 주소이다. 컨테이너의 포트를 공개한다는 것은 도커가 호스트 컴퓨터의 포트를 주시하다가 해당 포트로 들어오는 트래픽을 컨테이너에 전달해주는 것이다. 위의 예제는 호스트 컴퓨터의 8080번 포트로 들어온 트래픽이 컨테이너 80번 포트로 전달된 것이다.

* docker ls: 명령을 실행하면 현재 실행 중인 모든 컨테이너에 대한 정보를 볼 수 있다.
* docker ls --all: 상태와 상관없이 모든 컨테이너의 목록을 확인할 수 있다.
* docker ps: 동작하지 않는 컨테이너까지 조회하려면 뒤에 -a 옵션 추가

* docker top [container_id]: 컨테이너에서 실행 중인 모든 프로세스에 대한 정보가 출력된다.
* docker logs [container_id]: 대상 컨테이너에서 수집된 모든 로그를 출력한다.
* docker inspect [container_id]

    대상 컨테이너의 상세정보를 출력한다. 컨테이너의 가상 파일 시스템상의 경로, 실행 중인 명령, 접속된 가상 도커 네트워크 정보 등 어플리케이션에서 발생한 문제를 추적하는데 유용한 정보들이 제공된다.

* docker stats [container_id]: 실행 중인 컨테이너의 상태를 확인할 수 있다. 컨테이너의 CPU, 메모리, 디스크 사용량을 확인할 수 있다.
* docker rm --force $(docker container ls --all --quiet): 모든 컨테이너를 삭제하는 명령이다.
* docker rm {컨테이너 id 또는 이름}: 컨테이너 삭제
* docker rm `docker ps -a -q`: 모든 컨테이너 삭제
* docker rmi {옵션} {이미지 id}: 이미지 삭제
* docker stop $(docker ps -aq): 모든 컨테이너 중지
* docker system prune -a: 사용되지 않는 모든 도커 요소(컨테이너, 이미지, 네트워크, 볼륨 등) 삭제